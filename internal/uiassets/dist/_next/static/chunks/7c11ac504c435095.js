(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,52683,e=>{"use strict";var t=e.i(43476),n=e.i(71645);let a="examples/policy/base_high_risk.yaml",s="examples/policy/intents/intent_delete.json",i=[{id:"demo",label:"1. Run Demo",note:"Create deterministic runpack artifacts.",capability:"Runpack",tone:"runpack"},{id:"verify_demo",label:"2. Verify",note:"Validate runpack integrity and manifest digest.",capability:"Runpack",tone:"runpack"},{id:"receipt_demo",label:"3. Ticket Footer",note:"Generate paste-ready verification receipt.",capability:"Runpack",tone:"runpack"},{id:"regress_init",label:"4. Regress Init",note:"Build deterministic fixture from a run_id.",capability:"Regress",tone:"regress"},{id:"regress_run",label:"5. Regress Run",note:"Run graders and emit JUnit report.",capability:"Regress",tone:"regress"},{id:"policy_block_test",label:"6. Policy Block",note:"Demonstrate fail-closed non-allow decision.",capability:"Policy",tone:"policy"}];async function l(e,t){let n,a=await fetch(e,t),s=await a.text();try{n=JSON.parse(s)}catch{throw Error(`invalid JSON from ${e}: ${s}`)}if(!a.ok)throw Error(`request failed (${a.status}): ${JSON.stringify(n)}`);return n}function r(e){let t=i.find(t=>t.id===e);return t?.label??e}function c(e){return{ok:!1,workspace:"",gait_config_exists:!1,error:e instanceof Error?e.message:"unknown error"}}function o(e,t){let n=new Map;for(let t of e?.artifacts??[])n.set(t.key,t);let a=[];for(let e of t.artifacts??[]){let t=n.get(e.key),s=`${e.key}${e.modified_at?` @ ${e.modified_at}`:""}`;if(!t){a.push(s);continue}(t.exists!==e.exists||t.modified_at!==e.modified_at)&&a.push(s)}return a}function d(e,t,n,a){let s={};return"regress_init"===e&&(s.run_id=t.trim()),"policy_block_test"===e&&(s.policy_path=n,s.intent_path=a),s}function u(e,t,n,i){let l=t.trim()||"run_demo",r=n.trim()||a,c=i.trim()||s;switch(e){case"demo":return"gait demo --json";case"verify_demo":return"gait verify run_demo --json";case"receipt_demo":return"gait run receipt --from run_demo --json";case"regress_init":return`gait regress init --from ${l} --json`;case"regress_run":return"gait regress run --json --junit ./gait-out/junit.xml";case"policy_block_test":return`gait policy test ${r} ${c} --json`;default:return"gait --help"}}function p(e){return e.trim().split(/\s+/).filter(Boolean).map((e,t)=>0===t?{text:e,kind:"binary"}:e.startsWith("--")?{text:e,kind:"flag"}:1===t?{text:e,kind:"subcommand"}:{text:e,kind:"value"})}function h(e){let t=/("(?:\\.|[^"\\])*")(?=\s*:)|("(?:\\.|[^"\\])*")|(-?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?)|\b(true|false)\b|\bnull\b|([{}\[\],:])/g,n=[],a=0,s=t.exec(e);for(;null!==s;){s.index>a&&n.push({text:e.slice(a,s.index),kind:"plain"});let i="plain";s[1]?i="key":s[2]?i="string":s[3]?i="number":s[4]?i="boolean":"null"===s[0]?i="null":s[5]&&(i="punct"),n.push({text:s[0],kind:i}),a=t.lastIndex,s=t.exec(e)}return(a<e.length&&n.push({text:e.slice(a),kind:"plain"}),0===n.length)?[{text:e,kind:"plain"}]:n}function m(){let[e,a]=(0,n.useState)("loading"),[s,m]=(0,n.useState)(null),[x,g]=(0,n.useState)(null),[j,y]=(0,n.useState)(null),[b,f]=(0,n.useState)(i[0].id),[k,N]=(0,n.useState)("run_demo"),[_,v]=(0,n.useState)(""),[w,S]=(0,n.useState)(""),[C,$]=(0,n.useState)(null),[R,T]=(0,n.useState)(null),[A,O]=(0,n.useState)([]),[P,E]=(0,n.useState)(null),I=(0,n.useMemo)(()=>s?s.ok?`Workspace: ${s.workspace}`:`State error: ${s.error??"unknown error"}`:"Loading workspace...",[s]),J=(0,n.useMemo)(()=>u(b,k,_,w),[b,k,_,w]),F=(0,n.useMemo)(()=>x?JSON.stringify(x,null,2):'{\n  "status": "ready",\n  "message": "Run a scenario to view command output."\n}',[x]),L=(0,n.useMemo)(()=>s?JSON.stringify(s,null,2):'{\n  "status": "loading"\n}',[s]),U=async()=>{try{return await l("/api/state")}catch(e){return c(e)}};(0,n.useEffect)(()=>{(async()=>{try{await l("/api/health"),a("ok")}catch{a("error")}let e=await U();m(e),e.default_policy_path?v(e.default_policy_path):(e.policy_paths?.length??0)>0&&v(e.policy_paths[0]),e.default_intent_path?S(e.default_intent_path):(e.intent_paths?.length??0)>0&&S(e.intent_paths[0]),e.run_id&&N(e.run_id)})()},[]);let B=async e=>{y(e),f(e);try{let t=d(e,k,_,w),n=await l("/api/exec",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({command:e,args:t})}),a=await U();m(a),O(o(s,a)),$(e),T(new Date().toISOString()),g(n)}catch(e){g({error:e instanceof Error?e.message:"unknown error"})}finally{y(null)}},D=async(e,t)=>{navigator.clipboard&&(await navigator.clipboard.writeText(t),E(e),window.setTimeout(()=>E(t=>t===e?null:t),1200))},M=null!==j;return(0,t.jsxs)("div",{className:"page-shell",children:[(0,t.jsxs)("header",{className:"topbar",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{children:"Gait Playground"}),(0,t.jsx)("p",{children:"Local-first guided flows for runpack, regress, and policy validation."})]}),(0,t.jsxs)("div",{className:"topbar-right",children:[(0,t.jsx)("div",{className:`health-pill health-${e}`,children:"loading"===e?"Checking":"ok"===e?"Healthy":"Unavailable"}),(0,t.jsx)("span",{className:"workspace-pill",children:I})]})]}),(0,t.jsxs)("main",{className:"layout-grid",children:[(0,t.jsxs)("section",{className:"panel",children:[(0,t.jsxs)("div",{className:"panel-header",children:[(0,t.jsx)("h2",{children:"Scenario Flow"}),(0,t.jsx)("span",{className:"panel-note",children:"Click any step to run it."})]}),(0,t.jsx)("div",{className:"scenario-list",children:i.map(e=>(0,t.jsxs)("article",{className:`scenario-card ${b===e.id?"scenario-selected":""}`,children:[(0,t.jsxs)("div",{className:"scenario-header",children:[(0,t.jsx)("span",{className:`scenario-pill ${function(e){switch(e){case"runpack":default:return"tone-runpack";case"regress":return"tone-regress";case"policy":return"tone-policy"}}(e.tone)}`,children:e.capability}),(0,t.jsx)("span",{className:"scenario-id",children:e.id})]}),(0,t.jsx)("strong",{children:e.label}),(0,t.jsx)("p",{children:e.note}),(0,t.jsxs)("div",{className:"scenario-actions",children:[(0,t.jsx)("button",{type:"button",className:"ghost-button",onClick:()=>f(e.id),disabled:M,children:b===e.id?"Selected":"Select"}),(0,t.jsx)("button",{type:"button",className:"run-button",onClick:()=>void B(e.id),disabled:M,children:j===e.id?"Running...":"Run"})]})]},e.id))})]}),(0,t.jsxs)("section",{className:"panel",children:[(0,t.jsxs)("div",{className:"panel-header",children:[(0,t.jsx)("h2",{children:"Execution View"}),(0,t.jsx)("span",{className:"panel-note",children:"Preview exact command before running."})]}),(0,t.jsxs)("div",{className:"status-grid",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"status-label",children:"Last Action"}),(0,t.jsx)("strong",{children:C?r(C):"None yet"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"status-label",children:"Last Run At"}),(0,t.jsx)("strong",{children:R??"No runs yet"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"status-label",children:"Changed Artifacts"}),(0,t.jsx)("strong",{children:0===A.length?"None":A.join(", ")})]})]}),(0,t.jsxs)("div",{className:"input-grid",children:[(0,t.jsxs)("label",{children:["Regress Init run_id",(0,t.jsx)("input",{value:k,onChange:e=>N(e.target.value),disabled:M})]}),(0,t.jsxs)("label",{children:["Policy Fixture",(0,t.jsx)("select",{value:_,onChange:e=>v(e.target.value),disabled:M,children:(s?.policy_paths??[]).map(e=>(0,t.jsx)("option",{value:e,children:e},e))})]}),(0,t.jsxs)("label",{children:["Intent Fixture",(0,t.jsx)("select",{value:w,onChange:e=>S(e.target.value),disabled:M,children:(s?.intent_paths??[]).map(e=>(0,t.jsx)("option",{value:e,children:e},e))})]})]}),(0,t.jsxs)("div",{className:"code-panel",children:[(0,t.jsxs)("div",{className:"code-panel-header",children:[(0,t.jsx)("span",{children:"Command Preview"}),(0,t.jsx)("button",{type:"button",className:"copy-button",onClick:()=>void D("command",J),children:"command"===P?"Copied":"Copy"})]}),(0,t.jsx)("pre",{className:"command-block",children:p(J).map((e,n,a)=>(0,t.jsxs)("span",{className:`cmd-${e.kind}`,children:[e.text,n+1<a.length?" ":""]},`${e.text}-${n}`))})]}),(0,t.jsxs)("div",{className:"code-panel",children:[(0,t.jsxs)("div",{className:"code-panel-header",children:[(0,t.jsx)("span",{children:"Command Output"}),(0,t.jsx)("button",{type:"button",className:"copy-button",onClick:()=>void D("output",F),children:"output"===P?"Copied":"Copy"})]}),(0,t.jsx)("pre",{className:"code-block",children:h(F).map((e,n)=>(0,t.jsx)("span",{className:`json-${e.kind}`,children:e.text},`${e.kind}-${n}`))})]})]}),(0,t.jsxs)("section",{className:"panel",children:[(0,t.jsxs)("div",{className:"panel-header",children:[(0,t.jsx)("h2",{children:"Workspace State"}),(0,t.jsx)("button",{type:"button",className:"copy-button",onClick:()=>void D("state",L),children:"state"===P?"Copied":"Copy"})]}),(0,t.jsx)("pre",{className:"code-block",children:h(L).map((e,n)=>(0,t.jsx)("span",{className:`json-${e.kind}`,children:e.text},`${e.kind}-${n}`))})]})]})]})}e.s(["ACTIONS",0,i,"DEFAULT_INTENT_PATH",0,s,"DEFAULT_POLICY_PATH",0,a,"buildActionArgs",()=>d,"computeArtifactChanges",()=>o,"default",()=>m,"prettyAction",()=>r,"renderCommandPreview",()=>u,"stateFallback",()=>c,"tokenizeCommand",()=>p,"tokenizeJSON",()=>h])}]);